<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="https://wooinjae2.github.io/_next/static/css/66f55ef8e3bfada3d522.css" as="style"/><link rel="stylesheet" href="https://wooinjae2.github.io/_next/static/css/66f55ef8e3bfada3d522.css" data-n-g=""/><link rel="preload" href="https://wooinjae2.github.io/_next/static/css/6117b11fb8f30a1a4b13.css" as="style"/><link rel="stylesheet" href="https://wooinjae2.github.io/_next/static/css/6117b11fb8f30a1a4b13.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="https://wooinjae2.github.io/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="https://wooinjae2.github.io/_next/static/chunks/framework.00ee03d2fb17bd3ca80e.js" as="script"/><link rel="preload" href="https://wooinjae2.github.io/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.434add09c69d12fa3e78.js" as="script"/><link rel="preload" href="https://wooinjae2.github.io/_next/static/chunks/main-df3a32090c51be81ea5b.js" as="script"/><link rel="preload" href="https://wooinjae2.github.io/_next/static/chunks/pages/_app-6d83a31ab127e221ced3.js" as="script"/><link rel="preload" href="https://wooinjae2.github.io/_next/static/chunks/d7590e44e360613c62653565429d14f0827a37bd.8a3cf4ef34befa566070.js" as="script"/><link rel="preload" href="https://wooinjae2.github.io/_next/static/chunks/pages/til/20210624-365d48337c918760c109.js" as="script"/></head><body><div id="__next"><main class="Layout_mainItem__DF8a2"><nav class="leftPanel_nav__3Pzde"><div class="leftPanel_desc__-MvGo"><div class="leftPanel_circle__r8PcS"></div><h2>Injae Woo</h2><div><a style="cursor:pointer"> <svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true" style="font-size:20"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg></a></div></div><div class="leftPanel_menuList__WnkuP"></div></nav><main><div class="post_post__1w2T3"><div class="post_postTitle__1Xc4J"><h2>Closure</h2></div><hr/><div class="post_postBody__2vtXs"><br/><h3>Closure</h3><p>Closure는 내부함수가 외부함수의 맥락(context)에 접근할 수 있는 것을 가르킨다. javascript를 이용하는 고난이도의 테크닉을 구사하는데 필수적인 개념으로 활용된다.</p><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;font-family:&quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;font-size:12px"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">

function outter(){
  var title = &#x27;coding everybody&#x27;;
  return function (){
    alert(title);
  }
}
inner = outter();
inner();
</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px">

<span class="token keyword">function</span> <span class="token function">outter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token string">'coding everybody'</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
inner <span class="token operator">=</span> <span class="token function">outter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<br /></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div><p>outter 함수는 한번 호출 되고 난후 내부함수를 리턴하고 생을 마감했다. 생을 마감했음에도 불구하고, 리턴한 내부함수는 외부함수에 접근을 시도하고 성공적인 접근을 하고 있다. <br/>내부함수는 외부함수의 지역변수에 접근할 수 있는데 외부함수의 실행이 끝나고 소멸된 이후에도 내부함수가 외부함수의 변수에 접근할 수 있다. 이런 메커니즘을 클로저 라고 한다.<br/>클로저란 내부함수가 외부함수의 지역변수에 접근 할 수 있고, 외부함수는 외부함수의 지역변수를 사용하는 내부함수가 소멸될 때까지 소멸되지 않는<br/>조금 더 실용적인 예제<br/><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;font-family:&quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;font-size:12px"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">

function factory_movie(title){
  return {
    get_title: function (){
      return title; //매개변수는 함수안에서 지역변수로 사용되기 때문에 접근이 가능하다.
    },
    set_title: function(_title){
      title = _title;
    }
  }
  
}
ghost = factory_movie(&#x27;Ghost in the shell&#x27;);
matrix = factory_movie(&#x27;Matrix&#x27;);

alert(ghost.get_title());
alert(matrix.get_title());
 
ghost.set_title(&#x27;공각기동대&#x27;);
 
alert(ghost.get_title());
alert(matrix.get_title());
</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px">

<span class="token keyword">function</span> <span class="token function">factory_movie</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get_title</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> title<span class="token punctuation">;</span> <span class="token comment">//매개변수는 함수안에서 지역변수로 사용되기 때문에 접근이 가능하다.</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set_title</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">_title</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      title <span class="token operator">=</span> _title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span>
ghost <span class="token operator">=</span> <span class="token function">factory_movie</span><span class="token punctuation">(</span><span class="token string">'Ghost in the shell'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
matrix <span class="token operator">=</span> <span class="token function">factory_movie</span><span class="token punctuation">(</span><span class="token string">'Matrix'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span>ghost<span class="token punctuation">.</span><span class="token function">get_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>matrix<span class="token punctuation">.</span><span class="token function">get_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
ghost<span class="token punctuation">.</span><span class="token function">set_title</span><span class="token punctuation">(</span><span class="token string">'공각기동대'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token function">alert</span><span class="token punctuation">(</span>ghost<span class="token punctuation">.</span><span class="token function">get_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>matrix<span class="token punctuation">.</span><span class="token function">get_title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<br /></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div>클로저의 이러한 특성을 사용해 Private한 속성을 사용할 수 있도록 한다. 소프트웨어가 커지다보면 많은 사람의 손을 타고, 미래의 나, 과거의 나 등. 소프트웨어가 망가질 위험이 크다.<ul><li>1. title이라는 변수를 다른사람이 어떤 의미로 외부에서 사용하던, 이 내부변수에 영향을 줄 수 없다.</li><li>2. set title을 통해 값을 수정하려고 할경우 조건을 검사할수있다. 없다.</li></ul><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;font-family:&quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;font-size:12px"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">

var arr = []
for(var i = 0; i &lt; 5; i++){
    arr[i] = function(){
        return i;
    }
}
for(var index in arr) {
    console.log(arr[index]());
}

---------------------------------------------
var funcArray = [];
for(var i = 1; i &lt; 6; i++){
  funcArray[i] = function (idx){
      return function(){
        return idx;
      }
  }(i);
}


for(var index in funcArray){
    console.log(funcArray[index]());
}

</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px">

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> index <span class="token keyword">in</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">var</span> funcArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  funcArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">idx</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> idx<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> index <span class="token keyword">in</span> funcArray<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>funcArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<br /></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div>이렇게 하면 0,1,2,3,4가 아니라 5만 5번 출력되게 되는데, i의 값이 각각의 루프에서 변하며, 최종적으로 루프가 끝난뒤에 5라는 값을 가지고 있다. 그리고 return된 함수에서는 외부 스코프의 var키워드로 선언한 변수 i 참조하고 있기 때문이다. var 키워드로 선언한 i는 function scope이고 여기서는전역 변수로 선언되었고 이후 계속 참조를 하고 있기 때문에 이런 문제가 발생하며, 해결을 위해 아래 코드처럼 i값을 파라미터로 전달하여 함수의 copy된 로컬 변수로써 이용할 수 있다.<br/>또는 for문의 i값을 블록스코프를 갖는 let 키워드를 통해 선언</p></div><hr/><div class="post_reference__1-d9Y"><h2>출처</h2><div>생활코딩</div><div>http://conceptf1.blogspot.com/2013/11/javascript-closures.html</div></div></div></main></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/til/20210624","query":{},"buildId":"c_gTnHZ8xNyLLGNKA461o","assetPrefix":"https://wooinjae2.github.io","nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="https://wooinjae2.github.io/_next/static/chunks/polyfills-28654a8145d7603786fc.js"></script><script src="https://wooinjae2.github.io/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/chunks/framework.00ee03d2fb17bd3ca80e.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.434add09c69d12fa3e78.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/chunks/main-df3a32090c51be81ea5b.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/chunks/pages/_app-6d83a31ab127e221ced3.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/chunks/d7590e44e360613c62653565429d14f0827a37bd.8a3cf4ef34befa566070.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/chunks/pages/til/20210624-365d48337c918760c109.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/c_gTnHZ8xNyLLGNKA461o/_buildManifest.js" async=""></script><script src="https://wooinjae2.github.io/_next/static/c_gTnHZ8xNyLLGNKA461o/_ssgManifest.js" async=""></script></body></html>